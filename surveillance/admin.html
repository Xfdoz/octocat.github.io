<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Admin - Dashboard Surveillance RM</title>
</head>
<body class="admin-body">

    <nav class="sidebar">
        <div class="sidebar-header">
            <div class="logo-container">
                <img src="logo.png" alt="Logo" class="logo-sidebar">
            </div>
            <div class="admin-badge">
                <span class="dot"></span>
                <p>ADMIN PANEL</p>
            </div>
        </div>
        <ul class="nav-links">
            <li class="active" onclick="switchTab('dash')">ğŸ“Š Dashboard</li>
            <li onclick="switchTab('magasins')">ğŸª Magasins</li>
            <li onclick="switchTab('employes')">ğŸ‘¤ EmployÃ©s</li>
            <li onclick="switchTab('stats')">ğŸ“ˆ X - Flash</li>
            <li onclick="switchTab('historique')">ğŸ•’ Horaires</li>
        </ul>
        <a href="index.html" class="back-link" style="margin-top: auto; text-decoration: none; color: #94a3b8; font-size: 0.9rem;">â¬… Retour Accueil</a>
    </nav>

    <main class="main-admin">
        
        <section id="tab-dash" class="tab-content active">
            <h1 class="page-title">Tableau de Bord</h1>
            <div class="kpi-grid">
                <div class="kpi-card">
                    <span class="icon">ğŸª</span>
                    <div class="info"><h4 id="kpi-magasins">0</h4><p>Magasins</p></div>
                </div>
                <div class="kpi-card">
                    <span class="icon">ğŸ‘¥</span>
                    <div class="info"><h4 id="kpi-employes">0</h4><p>EmployÃ©s Actifs</p></div>
                </div>
                <div class="kpi-card">
                    <span class="icon">â±ï¸</span>
                    <div class="info"><h4 id="kpi-temps">0 min</h4><p>Temps Total</p></div>
                </div>
                <div class="kpi-card alert">
                    <span class="icon">âš ï¸</span>
                    <div class="info"><h4>Actif</h4><p>Statut Mensuel</p></div>
                </div>
            </div>

            <div class="container" style="margin-top: 25px; border: 1px dashed var(--accent-blue); padding: 15px;">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <span style="font-size: 1.2rem;">ğŸ”</span>
                    <input type="text" id="adminSearchInput" placeholder="Rechercher un magasin ou un salariÃ©..." 
                           onkeyup="filtrerDashboardAdmin()" 
                           style="flex: 1; background: transparent; border: none; color: white; font-size: 1.1rem; outline: none; margin-bottom:0;">
                </div>
            </div>

            <div id="details-complets-magasins" style="margin-top: 30px;"></div>
        </section>

        <section id="tab-magasins" class="tab-content">
            <h1 class="page-title">Gestion des Magasins</h1>
            <div class="container admin-container">
                <h3>â• Ajouter un Magasin</h3>
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="nomMagasin" placeholder="Nom du magasin" style="margin-bottom:0;">
                    <button onclick="creerMagasin()" style="width: 150px;">CrÃ©er</button>
                </div>
            </div>
            <div class="container admin-container">
                <h3>ğŸª Liste des Magasins</h3>
                <table class="admin-table">
                    <thead>
                        <tr><th>Nom</th><th>Date</th><th>EmployÃ©s</th><th>Actions</th></tr>
                    </thead>
                    <tbody id="table-magasins-body"></tbody>
                </table>
            </div>
        </section>

        <section id="tab-employes" class="tab-content">
            <h1 class="page-title">Gestion des EmployÃ©s</h1>
            <div class="container admin-container">
                <h3>ğŸ‘¤ Ajouter / Modifier des employÃ©s</h3>
                <label>SÃ©lectionner un magasin :</label>
                <select id="selectMagasinAdmin" onchange="chargerEmployesDuMagasin(this.value)"></select>
                
                <hr style="margin: 20px 0; border: 0; border-top: 1px solid rgba(255,255,255,0.1);">
                
                <div class="form-row" style="display: flex; gap: 10px; align-items: flex-end;">
                    <div style="flex: 2;">
                        <input type="text" id="nomEmploye" placeholder="Nom complet" style="width:100%; margin-bottom:0;">
                    </div>
                    <div style="flex: 1;">
                        <input type="number" id="tempsTel" placeholder="Min" style="width:100%; margin-bottom:0;">
                    </div>
                    <button onclick="ajouterEmploye()" style="width: auto; padding: 12px 25px;">â• AJOUTER</button>
                </div>

                <div id="liste-employes-edition" style="margin-top:20px;"></div>
            </div>
        </section>

        <section id="tab-stats" class="tab-content">
            <h1 class="page-title">GÃ©nÃ©rateur X - Flash</h1>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div class="container">
                    <h3>ğŸ“ Saisie des Manquants</h3>
                    <div id="formulaire-xflash">
                        <p style="color:var(--text-secondary)">Chargement des magasins...</p>
                    </div>
                    <button onclick="genererMessageRapport()" style="width:100%; margin-top:20px; background:var(--accent-blue);">ğŸ”¨ GÃ©nÃ©rer le bilan</button>
                </div>
                <div class="container">
                    <h3>ğŸ“‹ Bilan GÃ©nÃ©rÃ©</h3>
                    <textarea id="resultatRapport" style="width: 100%; height: 350px; background: rgba(0,0,0,0.2); color: #00d2ff; border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; padding: 15px; font-family: monospace; font-size: 0.9rem; resize: none;"></textarea>
                    <button onclick="copierRapport()" style="width:100%; margin-top:10px; background:#10b981;">ğŸ“‹ Copier le message</button>
                </div>
            </div>
        </section>

        <section id="tab-historique" class="tab-content">
            <h1 class="page-title">Horaires</h1>
            <div class="container">
                <p style="color: var(--text-secondary);">Journal des connexions.</p>
            </div>
        </section>

    </main>

    <script type="module" src="admin.js"></script>

    <script>
        window.switchTab = function(tabId) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.nav-links li').forEach(l => l.classList.remove('active'));
            const target = document.getElementById('tab-' + tabId);
            if(target) target.classList.add('active');
            if(event && event.currentTarget) event.currentTarget.classList.add('active');
        }
    </script>
</body>
</html>